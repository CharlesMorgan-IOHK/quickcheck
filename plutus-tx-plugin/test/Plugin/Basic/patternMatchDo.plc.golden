(program
  (let
    (nonrec)
    (datatypebind
      (datatype
        (tyvardecl Maybe (fun (type) (type)))
        (tyvardecl a (type))
        Maybe_match
        (vardecl Just (fun a [ Maybe a ])) (vardecl Nothing [ Maybe a ])
      )
    )
    (termbind
      (strict)
      (vardecl
        fMonadMaybe_c
        (all
          a
          (type)
          (all b (type) (fun [ Maybe a ] (fun (fun a [ Maybe b ]) [ Maybe b ])))
        )
      )
      (abs
        a
        (type)
        (abs
          b
          (type)
          (lam
            ds
            [ Maybe a ]
            (lam
              k
              (fun a [ Maybe b ])
              [
                [
                  { [ { Maybe_match a } ds ] [ Maybe b ] }
                  (lam
                    p
                    (prod a)
                    (let
                      (nonrec)
                      (termbind (strict) (vardecl x a) (proj 0 p))
                      [ k x ]
                    )
                  )
                ]
                (lam p (prod ) { Nothing b })
              ]
            )
          )
        )
      )
    )
    (datatypebind
      (datatype
        (tyvardecl Tuple2 (fun (type) (fun (type) (type))))
        (tyvardecl a (type)) (tyvardecl b (type))
        Tuple2_match
        (vardecl Tuple2 (fun a (fun b [ [ Tuple2 a ] b ])))
      )
    )
    (termbind
      (strict)
      (vardecl addInteger (fun (con integer) (fun (con integer) (con integer))))
      (builtin addInteger)
    )
    (termbind
      (strict)
      (vardecl addInteger (fun (con integer) (fun (con integer) (con integer))))
      (lam x (con integer) (lam y (con integer) [ [ addInteger x ] y ]))
    )
    (lam
      ds
      [ Maybe [ [ Tuple2 (con integer) ] (con integer) ] ]
      (lam
        ds
        [ Maybe (con integer) ]
        [
          [
            {
              { fMonadMaybe_c [ [ Tuple2 (con integer) ] (con integer) ] }
              (con integer)
            }
            ds
          ]
          (lam
            ds
            [ [ Tuple2 (con integer) ] (con integer) ]
            [
              {
                [ { { Tuple2_match (con integer) } (con integer) } ds ]
                [ Maybe (con integer) ]
              }
              (lam
                p
                (prod (con integer) (con integer))
                (let
                  (nonrec)
                  (termbind (strict) (vardecl x (con integer)) (proj 0 p))
                  (termbind (strict) (vardecl x (con integer)) (proj 1 p))
                  [
                    [ { { fMonadMaybe_c (con integer) } (con integer) } ds ]
                    (lam
                      y
                      (con integer)
                      [
                        { Just (con integer) }
                        [ [ addInteger [ [ addInteger x ] x ] ] y ]
                      ]
                    )
                  ]
                )
              )
            ]
          )
        ]
      )
    )
  )
)